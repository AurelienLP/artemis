# Artemis Next Generation

aka ArtemisNG has been designed to run tests using docker-compose, in order to be easily deployed.

## How to use

* Run Navitia services in docker containers:
    You can clone the repository navitia-docker-compose, available [here](https://github.com/CanalTP/navitia-docker-compose) and follow the instructions in the [readme](https://github.com/CanalTP/navitia-docker-compose/blob/master/README.md) file to have the whole Navitia environment running.
    - Once you set up all correctly, launch this command at the root directory of the repo:
    `docker-compose -f docker-compose.yml -f artemis/docker-artemis-instance.yml up`
    - To run real-time tests, Kirin is needed. Please refer to these [instructions](https://github.com/CanalTP/navitia-docker-compose/blob/master/kirin/README.md) to have it in the docker-compose. In this case, the command is:
    `docker-compose -f docker-compose.yml -f artemis/docker-artemis-instance.yml -f kirin/docker-compose_kirin.yml up`

* Create a virtual environment with the python packages in requirements.txt (for python 3):
    `mkvirtualenv --python=/usr/bin/python3 <venv_name>`
    `pip3 install -r requirements.txt`

  For python2:
    `pip install -r requirements_py2.txt`

* In default_settings.py, set the following parameters:
    - URL_JORMUN (with port)
    - URL_TYR
    - DATA_DIR (artemis data)
    - REFERENCE_FILE_PATH (the path to artemis references)
    - RESPONSE_FILE_PATH (Optional, output of the responses generated by artemis)
    - KIRIN_API (if needed)

* In the settings file, set 'USE_ARTEMIS_NG' to True

* Launch tests: `py.test artemis/tests`
    - If you don't want to call `cities`, add `--skip_cities`
    - If the data has already been binarized, add `--skip_bina`
    - If you want to show prints, you can also add this argument `-s`
